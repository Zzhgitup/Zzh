const s=JSON.parse(`{"key":"v-05e62f2b","path":"/blog/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/JS%E9%80%9A%E8%BF%87%E6%96%87%E4%BB%B6URL%E8%B7%AF%E5%BE%84%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6.html","title":"JS通过文件URL路径下载文件","lang":"zh-CN","frontmatter":{"title":"JS通过文件URL路径下载文件","date":"2022-07-24T16:39:55.000Z","icon":"blog","tag":["javascript"],"category":["记录"],"description":"const exportFile = (data, fileName, _this)=&gt;{ 　// 地址不存在时，禁止操作 if(!data)return; // 下载文件并保存到本地 const callback = (data)=&gt;{ 　　 // 创建a标签，使用 html5 download 属性下载， const link = document.createElement('a'); 　　 // 创建url对象 const objectUrl = window.URL.createObjectURL(new Blob([data])); link.style.display='none'; link.href=objectUrl; 　　 // 自定义文件名称， fileName 　　 link.download = fileName; 　　 document.body.appendChild(link); 　　 link.click(); 　　 // 适当释放url window.URL.revokeObjectURL(objectUrl); }; // 把接口返回的url地址转换为 blob const xhr = new XMLHttpRequest(); xhr.open('get', data, true); xhr.responseType = 'blob'; xhr.onload = ()=&gt; { 　　 // 返回文件流，进行下载处理 callback(xhr.response); }; xhr.send(); // 不要忘记发送 }; // ie和浏览器兼容模式会有问题，可以用下面代码调试。 　try{ exportFile(); // 调用方式 }catch(err){ // 兼容模式下，IE const exportBlob = new Blob([data]); if (navigator.userAgent.indexOf('Trident') &gt; -1) { window.navigator.msSaveBlob(data, fileName); } else { exportFile(); // 调用方式 } };","head":[["meta",{"property":"og:url","content":"https://oragekk.me/Zzh/blog/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/JS%E9%80%9A%E8%BF%87%E6%96%87%E4%BB%B6URL%E8%B7%AF%E5%BE%84%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6.html"}],["meta",{"property":"og:site_name","content":"ZiHao Blog"}],["meta",{"property":"og:title","content":"JS通过文件URL路径下载文件"}],["meta",{"property":"og:description","content":"const exportFile = (data, fileName, _this)=&gt;{ 　// 地址不存在时，禁止操作 if(!data)return; // 下载文件并保存到本地 const callback = (data)=&gt;{ 　　 // 创建a标签，使用 html5 download 属性下载， const link = document.createElement('a'); 　　 // 创建url对象 const objectUrl = window.URL.createObjectURL(new Blob([data])); link.style.display='none'; link.href=objectUrl; 　　 // 自定义文件名称， fileName 　　 link.download = fileName; 　　 document.body.appendChild(link); 　　 link.click(); 　　 // 适当释放url window.URL.revokeObjectURL(objectUrl); }; // 把接口返回的url地址转换为 blob const xhr = new XMLHttpRequest(); xhr.open('get', data, true); xhr.responseType = 'blob'; xhr.onload = ()=&gt; { 　　 // 返回文件流，进行下载处理 callback(xhr.response); }; xhr.send(); // 不要忘记发送 }; // ie和浏览器兼容模式会有问题，可以用下面代码调试。 　try{ exportFile(); // 调用方式 }catch(err){ // 兼容模式下，IE const exportBlob = new Blob([data]); if (navigator.userAgent.indexOf('Trident') &gt; -1) { window.navigator.msSaveBlob(data, fileName); } else { exportFile(); // 调用方式 } };"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-07-23T03:49:02.000Z"}],["meta",{"property":"article:author","content":"ZiHao"}],["meta",{"property":"article:tag","content":"javascript"}],["meta",{"property":"article:published_time","content":"2022-07-24T16:39:55.000Z"}],["meta",{"property":"article:modified_time","content":"2023-07-23T03:49:02.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"JS通过文件URL路径下载文件\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-07-24T16:39:55.000Z\\",\\"dateModified\\":\\"2023-07-23T03:49:02.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"ZiHao\\",\\"url\\":\\"https://orgaekk.me\\"}]}"]]},"headers":[],"git":{"createdTime":1690084142000,"updatedTime":1690084142000,"contributors":[{"name":"Zzhgitup","email":"99540215+Zzhgitup@users.noreply.github.com","commits":1}]},"readingTime":{"minutes":0.78,"words":234},"filePathRelative":"blog/学习笔记/JS通过文件URL路径下载文件.md","localizedDate":"2022年7月25日","excerpt":"<!--more-->\\n<div class=\\"language-java line-numbers-mode\\" data-ext=\\"java\\"><pre class=\\"shiki one-dark-pro\\" style=\\"background-color: #282c34\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span style=\\"color: #C678DD\\">const</span><span style=\\"color: #E06C75\\"> exportFile </span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #E06C75\\"> (data</span><span style=\\"color: #ABB2BF\\">,</span><span style=\\"color: #E06C75\\"> fileName</span><span style=\\"color: #ABB2BF\\">,</span><span style=\\"color: #E06C75\\"> _this)</span><span style=\\"color: #56B6C2\\">=&gt;</span><span style=\\"color: #E06C75\\">{</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">　</span><span style=\\"color: #7F848E; font-style: italic\\">// 地址不存在时，禁止操作</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  </span><span style=\\"color: #C678DD\\">if</span><span style=\\"color: #E06C75\\">(</span><span style=\\"color: #56B6C2\\">!</span><span style=\\"color: #E06C75\\">data)</span><span style=\\"color: #C678DD\\">return</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  </span><span style=\\"color: #7F848E; font-style: italic\\">// 下载文件并保存到本地</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  </span><span style=\\"color: #C678DD\\">const</span><span style=\\"color: #E06C75\\"> callback </span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #E06C75\\"> (data)</span><span style=\\"color: #56B6C2\\">=&gt;</span><span style=\\"color: #E06C75\\">{</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">　　 </span><span style=\\"color: #7F848E; font-style: italic\\">// 创建a标签，使用 html5 download 属性下载，</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    </span><span style=\\"color: #C678DD\\">const</span><span style=\\"color: #E06C75\\"> link </span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #E5C07B\\">document</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #61AFEF\\">createElement</span><span style=\\"color: #ABB2BF\\">(</span><span style=\\"color: #98C379\\">'a'</span><span style=\\"color: #ABB2BF\\">);</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">　　 </span><span style=\\"color: #7F848E; font-style: italic\\">// 创建url对象</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    </span><span style=\\"color: #C678DD\\">const</span><span style=\\"color: #E06C75\\"> objectUrl </span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #E5C07B\\">window</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">URL</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #61AFEF\\">createObjectURL</span><span style=\\"color: #ABB2BF\\">(</span><span style=\\"color: #C678DD\\">new</span><span style=\\"color: #ABB2BF\\"> </span><span style=\\"color: #61AFEF\\">Blob</span><span style=\\"color: #ABB2BF\\">([data]));</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    </span><span style=\\"color: #E5C07B\\">link</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">style</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">display</span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #98C379\\">'none'</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    </span><span style=\\"color: #E5C07B\\">link</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">href</span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #E06C75\\">objectUrl</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">　　 </span><span style=\\"color: #7F848E; font-style: italic\\">// 自定义文件名称， fileName</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">　　 </span><span style=\\"color: #E5C07B\\">link</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">download</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #E06C75\\"> fileName</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">　　 </span><span style=\\"color: #E5C07B\\">document</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">body</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #61AFEF\\">appendChild</span><span style=\\"color: #ABB2BF\\">(link);</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">　　 </span><span style=\\"color: #E5C07B\\">link</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #61AFEF\\">click</span><span style=\\"color: #ABB2BF\\">();</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">　　 </span><span style=\\"color: #7F848E; font-style: italic\\">// 适当释放url</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    </span><span style=\\"color: #E5C07B\\">window</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">URL</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #61AFEF\\">revokeObjectURL</span><span style=\\"color: #ABB2BF\\">(objectUrl);</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  }</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  </span><span style=\\"color: #7F848E; font-style: italic\\">// 把接口返回的url地址转换为 blob</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  </span><span style=\\"color: #C678DD\\">const</span><span style=\\"color: #E06C75\\"> xhr </span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #C678DD\\">new</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #61AFEF\\">XMLHttpRequest</span><span style=\\"color: #E06C75\\">()</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  </span><span style=\\"color: #E5C07B\\">xhr</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #61AFEF\\">open</span><span style=\\"color: #ABB2BF\\">(</span><span style=\\"color: #98C379\\">'get'</span><span style=\\"color: #ABB2BF\\">, data, </span><span style=\\"color: #D19A66\\">true</span><span style=\\"color: #ABB2BF\\">);</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  </span><span style=\\"color: #E5C07B\\">xhr</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">responseType</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #98C379\\">'blob'</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  </span><span style=\\"color: #E5C07B\\">xhr</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">onload</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #E06C75\\"> ()</span><span style=\\"color: #56B6C2\\">=&gt;</span><span style=\\"color: #E06C75\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">　　 </span><span style=\\"color: #7F848E; font-style: italic\\">// 返回文件流，进行下载处理</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    </span><span style=\\"color: #61AFEF\\">callback</span><span style=\\"color: #E06C75\\">(</span><span style=\\"color: #E5C07B\\">xhr</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">response</span><span style=\\"color: #E06C75\\">)</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  }</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  </span><span style=\\"color: #E5C07B\\">xhr</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #61AFEF\\">send</span><span style=\\"color: #ABB2BF\\">();</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #7F848E; font-style: italic\\">// 不要忘记发送</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">}</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color: #7F848E; font-style: italic\\">// ie和浏览器兼容模式会有问题，可以用下面代码调试。</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">　</span><span style=\\"color: #C678DD\\">try</span><span style=\\"color: #E06C75\\">{</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    </span><span style=\\"color: #61AFEF\\">exportFile</span><span style=\\"color: #E06C75\\">()</span><span style=\\"color: #ABB2BF\\">;</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #7F848E; font-style: italic\\">// 调用方式</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  }</span><span style=\\"color: #C678DD\\">catch</span><span style=\\"color: #E06C75\\">(</span><span style=\\"color: #E5C07B\\">err</span><span style=\\"color: #E06C75\\">){</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    </span><span style=\\"color: #7F848E; font-style: italic\\">// 兼容模式下，IE</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    </span><span style=\\"color: #C678DD\\">const</span><span style=\\"color: #E06C75\\"> exportBlob </span><span style=\\"color: #56B6C2\\">=</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #C678DD\\">new</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #61AFEF\\">Blob</span><span style=\\"color: #E06C75\\">([data])</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    </span><span style=\\"color: #C678DD\\">if</span><span style=\\"color: #E06C75\\"> (</span><span style=\\"color: #E5C07B\\">navigator</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">userAgent</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #61AFEF\\">indexOf</span><span style=\\"color: #ABB2BF\\">(</span><span style=\\"color: #98C379\\">'Trident'</span><span style=\\"color: #ABB2BF\\">)</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #56B6C2\\">&gt;</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #56B6C2\\">-</span><span style=\\"color: #D19A66\\">1</span><span style=\\"color: #E06C75\\">) {</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">      </span><span style=\\"color: #E5C07B\\">window</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #E5C07B\\">navigator</span><span style=\\"color: #ABB2BF\\">.</span><span style=\\"color: #61AFEF\\">msSaveBlob</span><span style=\\"color: #ABB2BF\\">(data, fileName);</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    } </span><span style=\\"color: #C678DD\\">else</span><span style=\\"color: #E06C75\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">      </span><span style=\\"color: #61AFEF\\">exportFile</span><span style=\\"color: #E06C75\\">()</span><span style=\\"color: #ABB2BF\\">;</span><span style=\\"color: #E06C75\\"> </span><span style=\\"color: #7F848E; font-style: italic\\">// 调用方式</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">    }</span></span>\\n<span class=\\"line\\"><span style=\\"color: #E06C75\\">  }</span><span style=\\"color: #ABB2BF\\">;</span></span>\\n<span class=\\"line\\"></span></code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","copyright":{"author":"ZiHao","license":"CC BY-NC-SA 4.0"},"autoDesc":true}`);export{s as data};

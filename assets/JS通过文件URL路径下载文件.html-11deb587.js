import{_ as s,o as n,c as a,f as l,e as p}from"./app-bebbc25d.js";const o={},e=p(`<div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E06C75;"> exportFile </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> (data</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> fileName</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> _this)</span><span style="color:#56B6C2;">=&gt;</span><span style="color:#E06C75;">{</span></span>
<span class="line"><span style="color:#E06C75;">　</span><span style="color:#7F848E;font-style:italic;">// 地址不存在时，禁止操作</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">if</span><span style="color:#E06C75;">(</span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">data)</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#7F848E;font-style:italic;">// 下载文件并保存到本地</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">const</span><span style="color:#E06C75;"> callback </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> (data)</span><span style="color:#56B6C2;">=&gt;</span><span style="color:#E06C75;">{</span></span>
<span class="line"><span style="color:#E06C75;">　　 </span><span style="color:#7F848E;font-style:italic;">// 创建a标签，使用 html5 download 属性下载，</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">const</span><span style="color:#E06C75;"> link </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">createElement</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;a&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">　　 </span><span style="color:#7F848E;font-style:italic;">// 创建url对象</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">const</span><span style="color:#E06C75;"> objectUrl </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">URL</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">createObjectURL</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Blob</span><span style="color:#ABB2BF;">([data]));</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">link</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">display</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;none&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">link</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">href</span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;">objectUrl</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">　　 </span><span style="color:#7F848E;font-style:italic;">// 自定义文件名称， fileName</span></span>
<span class="line"><span style="color:#E06C75;">　　 </span><span style="color:#E5C07B;">link</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">download</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> fileName</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">　　 </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">appendChild</span><span style="color:#ABB2BF;">(link);</span></span>
<span class="line"><span style="color:#E06C75;">　　 </span><span style="color:#E5C07B;">link</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">click</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">　　 </span><span style="color:#7F848E;font-style:italic;">// 适当释放url</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">URL</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">revokeObjectURL</span><span style="color:#ABB2BF;">(objectUrl);</span></span>
<span class="line"><span style="color:#E06C75;">  }</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#7F848E;font-style:italic;">// 把接口返回的url地址转换为 blob</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">const</span><span style="color:#E06C75;"> xhr </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">new</span><span style="color:#E06C75;"> </span><span style="color:#61AFEF;">XMLHttpRequest</span><span style="color:#E06C75;">()</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">xhr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;get&#39;</span><span style="color:#ABB2BF;">, data, </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">xhr</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">responseType</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&#39;blob&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">xhr</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">onload</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> ()</span><span style="color:#56B6C2;">=&gt;</span><span style="color:#E06C75;"> {</span></span>
<span class="line"><span style="color:#E06C75;">　　 </span><span style="color:#7F848E;font-style:italic;">// 返回文件流，进行下载处理</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#61AFEF;">callback</span><span style="color:#E06C75;">(</span><span style="color:#E5C07B;">xhr</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">response</span><span style="color:#E06C75;">)</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">  }</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">xhr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">send</span><span style="color:#ABB2BF;">();</span><span style="color:#E06C75;"> </span><span style="color:#7F848E;font-style:italic;">// 不要忘记发送</span></span>
<span class="line"><span style="color:#E06C75;">}</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ie和浏览器兼容模式会有问题，可以用下面代码调试。</span></span>
<span class="line"><span style="color:#E06C75;">　</span><span style="color:#C678DD;">try</span><span style="color:#E06C75;">{</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#61AFEF;">exportFile</span><span style="color:#E06C75;">()</span><span style="color:#ABB2BF;">;</span><span style="color:#E06C75;"> </span><span style="color:#7F848E;font-style:italic;">// 调用方式</span></span>
<span class="line"><span style="color:#E06C75;">  }</span><span style="color:#C678DD;">catch</span><span style="color:#E06C75;">(</span><span style="color:#E5C07B;">err</span><span style="color:#E06C75;">){</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#7F848E;font-style:italic;">// 兼容模式下，IE</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">const</span><span style="color:#E06C75;"> exportBlob </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">new</span><span style="color:#E06C75;"> </span><span style="color:#61AFEF;">Blob</span><span style="color:#E06C75;">([data])</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">if</span><span style="color:#E06C75;"> (</span><span style="color:#E5C07B;">navigator</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">userAgent</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">indexOf</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Trident&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">) {</span></span>
<span class="line"><span style="color:#E06C75;">      </span><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">navigator</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">msSaveBlob</span><span style="color:#ABB2BF;">(data, fileName);</span></span>
<span class="line"><span style="color:#E06C75;">    } </span><span style="color:#C678DD;">else</span><span style="color:#E06C75;"> {</span></span>
<span class="line"><span style="color:#E06C75;">      </span><span style="color:#61AFEF;">exportFile</span><span style="color:#E06C75;">()</span><span style="color:#ABB2BF;">;</span><span style="color:#E06C75;"> </span><span style="color:#7F848E;font-style:italic;">// 调用方式</span></span>
<span class="line"><span style="color:#E06C75;">    }</span></span>
<span class="line"><span style="color:#E06C75;">  }</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>调用方式</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">exportFile</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#98C379;">&quot;https://reading.oss.iyougu.com/uploads/mp/opus/1c5a8b6a391742cf93595d0a506b2d43.mp3&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#98C379;">&quot;测试.mp3&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3);function c(t,r){return n(),a("div",null,[l("more"),e])}const y=s(o,[["render",c],["__file","JS通过文件URL路径下载文件.html.vue"]]);export{y as default};
